<div class="page-container fade-in">
  <div class="page-header">
    <div>
      <h1 class="page-title">Bills</h1>
      <p class="page-subtitle">Manage customer invoices and billing</p>
    </div>
    <button class="btn btn-primary" (click)="showCreateForm = true" *ngIf="!showCreateForm">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" width="20" height="20">
        <line x1="12" y1="5" x2="12" y2="19" stroke-width="2" stroke-linecap="round"/>
        <line x1="5" y1="12" x2="19" y2="12" stroke-width="2" stroke-linecap="round"/>
      </svg>
      Create New Bill
    </button>
  </div>

  <!-- Bill Creation Form -->
  <div *ngIf="showCreateForm" class="card mb-4">
    <app-bill-form 
      (saved)="onBillCreated()" 
      (cancelled)="showCreateForm = false">
    </app-bill-form>
  </div>

  <div *ngIf="errorMessage" class="alert alert-danger">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <circle cx="12" cy="12" r="10" stroke-width="2"/>
      <line x1="15" y1="9" x2="9" y2="15" stroke-width="2" stroke-linecap="round"/>
      <line x1="9" y1="9" x2="15" y2="15" stroke-width="2" stroke-linecap="round"/>
    </svg>
    {{ errorMessage }}
  </div>

  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
  </div>

  <div *ngIf="!loading && bills.length === 0" class="empty-state-container">
    <div class="empty-state-card">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" class="empty-icon">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke-width="2"/>
        <polyline points="14 2 14 8 20 8" stroke-width="2"/>
        <line x1="16" y1="13" x2="8" y2="13" stroke-width="2"/>
        <line x1="16" y1="17" x2="8" y2="17" stroke-width="2"/>
      </svg>
      <h3>No bills available</h3>
      <p>No billing records found in the system</p>
    </div>
  </div>

  <div *ngIf="!loading && bills.length > 0" class="grid grid-cols-3 gap-3">
    <div *ngFor="let bill of bills" class="bill-card" (click)="viewBill(bill)">
      <div class="bill-card-header">
        <div class="bill-id">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke-width="2"/>
            <polyline points="14 2 14 8 20 8" stroke-width="2"/>
          </svg>
          <span>Bill #{{ bill.id }}</span>
        </div>
      </div>

      <div class="bill-card-body">
        <div class="bill-info-row">
          <span class="label">Customer ID:</span>
          <span class="badge badge-info">#{{ bill.customerId }}</span>
        </div>
        <div class="bill-info-row">
          <span class="label">Date:</span>
          <span class="value">{{ formatDate(bill.billingDate) }}</span>
        </div>
        <div class="bill-info-row">
          <span class="label">Items:</span>
          <span class="value">{{ bill.productItems.length || 0 }} products</span>
        </div>
      </div>

      <div class="bill-card-footer">
        <span class="total-label">Total Amount</span>
        <span class="total-value">{{ calculateTotal(bill).toFixed(2) }} DH</span>
      </div>

      <div class="bill-card-action">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <polyline points="9 18 15 12 9 6" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </div>
    </div>
  </div>
</div>
